{
  "$schema": "1.0.0",
  "$id": "https://github.com/umputun/cronn/app/crontab/yaml-config",
  "$ref": "#/$defs/YamlConfig",
  "$defs": {
    "JobSpec": {
      "properties": {
        "spec": {
          "type": "string",
          "pattern": "^(@(yearly|annually|monthly|weekly|daily|midnight|hourly|every\\s+[0-9]+[smh])|([0-9*",
          "description": "Cron specification string (e.g. '0 * * * *' or '@daily')"
        },
        "sched": {
          "$ref": "#/$defs/Schedule",
          "description": "Structured schedule format (alternative to spec)"
        },
        "command": {
          "type": "string",
          "minLength": 1,
          "description": "Command to execute"
        },
        "name": {
          "type": "string",
          "description": "Optional job name or description for better logging"
        },
        "repeater": {
          "$ref": "#/$defs/RepeaterConfig",
          "description": "Job-specific repeater configuration to override global settings"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "command"
      ]
    },
    "RepeaterConfig": {
      "properties": {
        "attempts": {
          "type": "integer",
          "maximum": 100,
          "minimum": 1,
          "description": "Number of retry attempts"
        },
        "duration": {
          "type": "integer",
          "description": "Initial retry delay (e.g. 1s or 500ms)"
        },
        "factor": {
          "type": "number",
          "maximum": 10.0,
          "minimum": 1.0,
          "description": "Backoff multiplication factor"
        },
        "jitter": {
          "type": "boolean",
          "description": "Enable random jitter to avoid thundering herd"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Schedule": {
      "properties": {
        "minute": {
          "type": "string",
          "pattern": "^([0-5]?[0-9]|\\*|\\*/[0-9]+|[0-9]+-[0-9]+|[0-9]+",
          "description": "Minute field (0-59 or * or */n)"
        },
        "hour": {
          "type": "string",
          "pattern": "^([01]?[0-9]|2[0-3]|\\*|\\*/[0-9]+|[0-9]+-[0-9]+|[0-9]+",
          "description": "Hour field (0-23 or * or */n)"
        },
        "day": {
          "type": "string",
          "pattern": "^([1-9]|[12][0-9]|3[01]|\\*|\\*/[0-9]+|[0-9]+-[0-9]+|[0-9]+",
          "description": "Day of month field (1-31 or * or */n)"
        },
        "month": {
          "type": "string",
          "pattern": "^([1-9]|1[0-2]|\\*|\\*/[0-9]+|[0-9]+-[0-9]+|[0-9]+",
          "description": "Month field (1-12 or * or */n)"
        },
        "weekday": {
          "type": "string",
          "pattern": "^([0-7]|\\*|\\*/[0-9]+|[0-9]+-[0-9]+|[0-9]+",
          "description": "Weekday field (0-7 where 0 and 7 are Sunday or * or */n)"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "YamlConfig": {
      "properties": {
        "jobs": {
          "items": {
            "$ref": "#/$defs/JobSpec"
          },
          "type": "array",
          "minItems": 1,
          "description": "List of cron jobs to execute"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "jobs"
      ]
    }
  },
  "title": "Cronn YAML Configuration Schema",
  "description": "Schema for cronn YAML configuration file"
}